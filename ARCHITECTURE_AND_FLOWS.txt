/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESEARCHSPHEREHUB - COMPLETE SYSTEM ARCHITECTURE & FLOWS
   Visual Diagrams & Explanations
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */


ğŸ“Š SYSTEM ARCHITECTURE DIAGRAM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CLIENT (Browser)                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  React Application (http://localhost:5173)                              â”‚ â”‚
â”‚  â”‚  â”œâ”€ Pages (Login, Search, Bookmarks, Upload)                           â”‚ â”‚
â”‚  â”‚  â”œâ”€ Components (buttons, forms, lists)                                 â”‚ â”‚
â”‚  â”‚  â”œâ”€ Services (authService, researchService, etc)                       â”‚ â”‚
â”‚  â”‚  â””â”€ State Management (useState, useContext)                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â–²
                                   â”‚ HTTP REST API
                                   â”‚ JSON payloads
                                   â”‚ Authorization header
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         BACKEND SERVER                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Express.js Application (http://localhost:5000)                        â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚ Request â†’ Routes â†’ Controllers â†’ Services â†’ Database â†’ Response â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  Routes:                Controllers:              Services:       â”‚ â”‚
â”‚  â”‚  â”œâ”€ /auth/*            â”œâ”€ authController         â”œâ”€ userService  â”‚ â”‚
â”‚  â”‚  â”œâ”€ /research/*        â”œâ”€ researchController     â”œâ”€ researchSvc  â”‚ â”‚
â”‚  â”‚  â””â”€ /bookmarks/*       â””â”€ bookmarkController     â””â”€ bookmarkSvc  â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  Middleware:                                                       â”‚ â”‚
â”‚  â”‚  â”œâ”€ authMiddleware     (JWT verification)                         â”‚ â”‚
â”‚  â”‚  â”œâ”€ validation         (Input validation)                         â”‚ â”‚
â”‚  â”‚  â”œâ”€ errorHandler       (Error handling)                           â”‚ â”‚
â”‚  â”‚  â””â”€ cors               (Cross-origin requests)                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â–²
                                   â”‚ Prisma ORM
                                   â”‚ SQL Queries
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      POSTGRESQL DATABASE                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Tables:                                                                 â”‚ â”‚
â”‚  â”‚ â”œâ”€ User (id, email, password, name, role)                             â”‚ â”‚
â”‚  â”‚ â”œâ”€ ResearchPaper (id, title, authors, type, content, userId)          â”‚ â”‚
â”‚  â”‚ â””â”€ Bookmark (id, userId, paperId)                                    â”‚ â”‚
â”‚  â”‚                                                                      â”‚ â”‚
â”‚  â”‚ Relationships:                                                       â”‚ â”‚
â”‚  â”‚ â”œâ”€ User (1) â”€â”€â†’ (Many) ResearchPaper                               â”‚ â”‚
â”‚  â”‚ â”œâ”€ User (1) â”€â”€â†’ (Many) Bookmark â†â”€â”€ (Many) ResearchPaper           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”‘ AUTHENTICATION FLOW (JWT)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1ï¸âƒ£ USER REGISTRATION
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

User enters credentials in Frontend
    â†“
Frontend POST /api/auth/register
    â”œâ”€ email: "user@example.com"
    â”œâ”€ name: "John Doe"
    â”œâ”€ password: "password123"
    â””â”€ confirmPassword: "password123"
    â†“
Express receives request
    â†“
Validation middleware checks inputs
    â†“
Auth handler calls UserService.register()
    â”œâ”€ Check if email already exists
    â”œâ”€ Hash password with bcrypt
    â”‚  (password123 â†’ $2b$10$encrypted_hash)
    â”œâ”€ Insert user into database
    â”œâ”€ Generate JWT token
    â”‚  Header: { alg: "HS256" }
    â”‚  Payload: { id, email, role, exp }
    â”‚  Signature: HMAC-SHA256
    â””â”€ Return token to frontend
    â†“
Frontend receives response
    â”œâ”€ Saves token in localStorage
    â””â”€ Redirects to home page


2ï¸âƒ£ USER LOGIN
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

User enters email & password
    â†“
Frontend POST /api/auth/login
    â”œâ”€ email: "user@example.com"
    â””â”€ password: "password123"
    â†“
Express receives request
    â†“
Auth handler calls UserService.login()
    â”œâ”€ Find user by email
    â”œâ”€ Compare password with hashed version
    â”‚  bcrypt.compare("password123", hash)
    â”œâ”€ If match, generate JWT token
    â””â”€ Return token to frontend
    â†“
Frontend saves token in localStorage


3ï¸âƒ£ MAKING PROTECTED REQUESTS
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Frontend wants to create a paper
    â†“
Get token from localStorage
    â†“
Frontend GET /api/research/create
    â”œâ”€ Headers: {
    â”‚    "Authorization": "Bearer eyJhbGciOiJIUzI1NiIs..."
    â”‚  }
    â””â”€ Body: { title, authors, content, ... }
    â†“
Express receives request
    â†“
authMiddleware checks Authorization header
    â”œâ”€ Extract token from "Bearer {token}"
    â”œâ”€ Verify token with JWT_SECRET
    â”‚  If signature doesn't match â†’ Invalid!
    â”‚  If token expired â†’ Expired!
    â”œâ”€ Decode token to get user id, email, role
    â””â”€ Attach decoded user to request object
    â†“
Controller receives request with user info
    â”œâ”€ User available as req.user.id
    â”œâ”€ Creates paper with userId = req.user.id
    â””â”€ Returns saved paper
    â†“
Frontend receives paper


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“¡ API REQUEST/RESPONSE FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

REQUEST FLOW (Frontend â†’ Backend â†’ Database)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Frontend Call: researchService.searchPapers("AI", "PAPER", ["ML"])
    â†“
Axios creates GET request:
    URL: http://localhost:5000/api/research/search?search=AI&type=PAPER&tags=ML
    â”œâ”€ Headers: {
    â”‚    "Authorization": "Bearer {token}",
    â”‚    "Content-Type": "application/json"
    â”‚  }
    â””â”€ Timeout: 30s
    â†“
Express Route Matcher:
    GET /api/research/search
    â†“
Validation Rules Check:
    â”œâ”€ type must be in ["PAPER", "JOURNAL", "CONFERENCE"] âœ“
    â”œâ”€ limit must be number â‰¤ 100 âœ“
    â””â”€ offset must be â‰¥ 0 âœ“
    â†“
If validation fails:
    â†’ Send 400 Bad Request with errors
    â†“
researchController.searchResearchPapers()
    â”œâ”€ Parse query parameters
    â”œâ”€ Build filter object:
    â”‚  {
    â”‚    type: "PAPER",
    â”‚    tags: { hasSome: ["ML"] },
    â”‚    OR: [
    â”‚      { title: { contains: "AI" } },
    â”‚      { content: { contains: "AI" } },
    â”‚      { authors: { hasSome: ["AI"] } }
    â”‚    ]
    â”‚  }
    â””â”€ Call researchService.searchResearchPapers(filters)
    â†“
Prisma executes query:
    SELECT * FROM "ResearchPaper"
    WHERE type = 'PAPER'
        AND tags && ARRAY['ML']
        AND (
            title ILIKE '%AI%'
            OR content ILIKE '%AI%'
            OR 'AI' = ANY(authors)
        )
    ORDER BY "createdAt" DESC
    LIMIT 10 OFFSET 0
    â†“
PostgreSQL Database Search:
    â”œâ”€ Check ResearchPaper table
    â”œâ”€ Apply filters
    â”œâ”€ Get total count
    â””â”€ Return results (10 papers)
    â†“
Prisma returns array of papers:
    [
      {
        id: "paper-1",
        title: "Machine Learning in AI",
        authors: ["John Doe"],
        type: "PAPER",
        ...
      },
      ...
    ]
    â†“
Controller formats response:
    sendSuccess(res, {
      data: papers,
      total: 47,
      limit: 10,
      offset: 0,
      pages: 5
    })
    â†“
Express sends HTTP 200 response:
    {
      "success": true,
      "message": "Search completed",
      "data": {
        "data": [...],
        "total": 47,
        "limit": 10,
        "offset": 0,
        "pages": 5
      }
    }
    â†“
Browser receives JSON response
    â†“
Axios parses JSON
    â†“
Frontend updates state with papers
    â†“
React re-renders search results
    â†“
User sees papers on screen âœ“


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“‹ COMPLETE REQUEST LIFECYCLE EXAMPLE: Create Paper
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

STEP 1: Frontend Initiates Request
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
User fills form and clicks "Create Paper"

Form Data:
{
  title: "AI in Healthcare",
  authors: ["John Smith", "Jane Doe"],
  type: "PAPER",
  content: "This paper explores the intersection of artificial...",
  source: "https://arxiv.org/abs/2302.01234",
  publishDate: "2023-02-01",
  tags: ["AI", "Healthcare", "ML"]
}

Frontend calls:
  researchService.createResearchPaper(
    "AI in Healthcare",
    ["John Smith", "Jane Doe"],
    "PAPER",
    "This paper explores...",
    "https://arxiv.org/abs/2302.01234",
    "2023-02-01",
    ["AI", "Healthcare", "ML"]
  )

Which translates to:
  POST http://localhost:5000/api/research HTTP/1.1
  Content-Type: application/json
  Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

  {
    "title": "AI in Healthcare",
    "authors": ["John Smith", "Jane Doe"],
    "type": "PAPER",
    "content": "This paper explores...",
    "source": "https://arxiv.org/abs/2302.01234",
    "publishDate": "2023-02-01T00:00:00Z",
    "tags": ["AI", "Healthcare", "ML"]
  }


STEP 2: Express Processes Request
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Express receives POST request and matches it to route:
  POST /api/research (in researchRoutes.ts)

Middleware executes in order:
  1ï¸âƒ£ authMiddleware
     â”œâ”€ Extracts token from header
     â”œâ”€ Verifies signature with JWT_SECRET
     â”œâ”€ Decodes payload
     â””â”€ Attaches to request: req.user = { id: "user-123", email: "...", role: "USER" }

  2ï¸âƒ£ researchValidation.create
     â”œâ”€ Checks title is not empty
     â”œâ”€ Checks authors is array with â‰¥1 item
     â”œâ”€ Checks type is valid enum
     â”œâ”€ Checks content is not empty
     â”œâ”€ Checks source is not empty
     â”œâ”€ Checks publishDate is valid ISO date (optional)
     â””â”€ Checks tags is array (optional)

  3ï¸âƒ£ handleValidationErrors
     â”œâ”€ If any validation failed, send 400 error
     â””â”€ If all passed, continue to controller

  4ï¸âƒ£ ResearchController.createResearchPaper()
     â”œâ”€ Check if user authenticated (req.user exists) âœ“
     â”œâ”€ Extract data from req.body
     â”œâ”€ Call ResearchService.createResearchPaper()
     â”‚
     â””â”€ Service execution:
           â”œâ”€ Call prisma.researchPaper.create({
           â”‚    data: {
           â”‚      title: "AI in Healthcare",
           â”‚      authors: ["John Smith", "Jane Doe"],
           â”‚      type: "PAPER",
           â”‚      content: "This paper explores...",
           â”‚      source: "https://arxiv.org/abs/2302.01234",
           â”‚      publishDate: new Date("2023-02-01"),
           â”‚      tags: ["AI", "Healthcare", "ML"],
           â”‚      userId: "user-123"  â† âš ï¸  Important: Links to user
           â”‚    }
           â”‚  })
           â”‚
           â””â”€ Prisma generates SQL and executes:
                INSERT INTO "ResearchPaper"
                (id, title, authors, type, content, source, publishDate, tags, userId, createdAt, updatedAt)
                VALUES
                ('generated-uuid', 'AI in Healthcare', '{"John Smith","Jane Doe"}', 'PAPER', '...', '...', '2023-02-01', '{"AI","Healthcare","ML"}', 'user-123', NOW(), NOW())

               Database returns created record with all fields including generated ID


STEP 3: Database Stores Data
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
PostgreSQL executes INSERT statement:
  â”œâ”€ Generates unique ID for paper
  â”œâ”€ Validates foreign key (userId exists)
  â”œâ”€ Inserts into ResearchPaper table
  â”œâ”€ Indexes by userId, type, title, tags for future searches
  â””â”€ Returns complete record


STEP 4: Response Sent Back
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Prisma returns created paper object:
{
  id: "clh3bjk5n0000qhz3c1d2e3f4",
  title: "AI in Healthcare",
  authors: ["John Smith", "Jane Doe"],
  type: "PAPER",
  content: "This paper explores...",
  source: "https://arxiv.org/abs/2302.01234",
  publishDate: "2023-02-01T00:00:00.000Z",
  tags: ["AI", "Healthcare", "ML"],
  userId: "user-123",
  createdAt: "2024-02-14T10:30:45.123Z",
  updatedAt: "2024-02-14T10:30:45.123Z"
}

sendSuccess() formats response:
{
  "success": true,
  "message": "Research paper created successfully",
  "data": {
    "id": "clh3bjk5n0000qhz3c1d2e3f4",
    "title": "AI in Healthcare",
    "authors": ["John Smith", "Jane Doe"],
    "type": "PAPER",
    "content": "This paper explores...",
    "source": "https://arxiv.org/abs/2302.01234",
    "publishDate": "2023-02-01T00:00:00.000Z",
    "tags": ["AI", "Healthcare", "ML"],
    "userId": "user-123",
    "createdAt": "2024-02-14T10:30:45.123Z",
    "updatedAt": "2024-02-14T10:30:45.123Z"
  }
}

Express sends HTTP 201 Created with response body


STEP 5: Frontend Receives Response
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Axios interceptor receives response:
  â”œâ”€ Checks status (201 Created) âœ“
  â”œâ”€ Parses JSON
  â””â”€ Returns data.data (the created paper object)

Frontend code:
  const response = await researchService.createResearchPaper(...)
  console.log(response)
  // {
  //   id: "clh3bjk5n0000qhz3c1d2e3f4",
  //   title: "AI in Healthcare",
  //   ...
  // }


STEP 6: Frontend Updates UI
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Frontend updates state:
  â”œâ”€ Add paper to papers array
  â”œâ”€ Clear form inputs
  â”œâ”€ Show success message
  â””â”€ Navigate to paper detail view (optional)

User sees their created paper on screen âœ“


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”„ BOOKMARK FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ADDING A BOOKMARK:

User clicks bookmark button on paper "AI in Healthcare"
    â†“
Frontend calls: bookmarkService.addBookmark("clh3bjk5n0000qhz3c1d2e3f4")
    â†“
POST /api/bookmarks/clh3bjk5n0000qhz3c1d2e3f4
Authorization: Bearer {token}
    â†“
BookmarkController.addBookmark()
    â”œâ”€ Verify user authenticated (req.user.id = "user-123")
    â”œâ”€ Get paperId from params ("clh3bjk5n0000qhz3c1d2e3f4")
    â”œâ”€ Call BookmarkService.addBookmark("user-123", "clh3bjk5n0000qhz3c1d2e3f4")
    â”‚
    â””â”€ Prisma upsert (create if not exists, do nothing if exists):
         INSERT INTO "Bookmark" (id, userId, paperId)
         VALUES ('new-uuid', 'user-123', 'clh3bjk5n0000qhz3c1d2e3f4')
         ON CONFLICT ON CONSTRAINT "Bookmark_userId_paperId_key"
         DO NOTHING
    â†“
Response: HTTP 201 Created with bookmark object
    â†“
Frontend updates UI:
    â”œâ”€ Change button to "â˜… Bookmarked" (filled star)
    â”œâ”€ Add paper to bookmarks list
    â””â”€ Show success toast


REMOVING A BOOKMARK:

User clicks bookmark button again (now showing as bookmarked)
    â†“
Frontend calls: bookmarkService.removeBookmark("clh3bjk5n0000qhz3c1d2e3f4")
    â†“
DELETE /api/bookmarks/clh3bjk5n0000qhz3c1d2e3f4
Authorization: Bearer {token}
    â†“
BookmarkController.removeBookmark()
    â”œâ”€ Verify user authenticated
    â”œâ”€ Delete bookmark where userId = "user-123" AND paperId = "clh3bjk5n0000qhz3c1d2e3f4"
    â”‚
    â””â”€ Prisma:
         DELETE FROM "Bookmark"
         WHERE userId = 'user-123' AND paperId = 'clh3bjk5n0000qhz3c1d2e3f4'
    â†“
Response: HTTP 200 OK with success message
    â†“
Frontend updates UI:
    â”œâ”€ Change button to "â˜† Bookmark" (empty star)
    â”œâ”€ Remove paper from bookmarks list
    â””â”€ Show success toast


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš¨ ERROR HANDLING FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

When a request fails, the error flows through the error handler:

Scenario: User tries to update paper they don't own

PUT /api/research/other-users-paper-id
Authorization: Bearer {token}

ResearchController checks ownership:
    const paper = await prisma.researchPaper.findFirst({
      where: {
        id: "other-users-paper-id",
        userId: "my-user-id"  â† âš ï¸  Fails! Paper owned by someone else
      }
    })

If not found:
    throw notFoundError("Research paper not found")

notFoundError() creates:
    new ApiError(404, "Research paper not found")

errorHandler middleware catches it:
    â”œâ”€ Checks if error is ApiError (yes)
    â”œâ”€ Extracts status code (404)
    â”œâ”€ Formats response
    â””â”€ Sends HTTP response:
       {
         "success": false,
         "message": "Research paper not found"
       }

Browser receives 404 response
    â†“
Axios error interceptor catches it:
    â”œâ”€ Checks status code (401, 403, 404, etc)
    â”œâ”€ If 401: clears token and redirects to login
    â”œâ”€ Otherwise: rejects promise
    â””â”€ Frontend catches error and shows message

Frontend shows error message: "Paper not found"


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š DATA FLOW DIAGRAM: Search to Bookmark
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Frontend Search                        Backend Processing                Database
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

User types "AI"                 
in search box                        
        â”‚                             
        â”œâ”€ 300ms debounce
        â”‚
        â””â”€ GET /search?search=AI
             â”‚
             â”œâ”€ authMiddleware (verify token)
             â”‚
             â”œâ”€ validation (check params)
             â”‚
             â””â”€ searchResearchPapers()
                  â”‚
                  â””â”€ researchService
                       â”‚
                       â””â”€ prisma.researchPaper.findMany({
                            where: {
                              OR: [
                                {title: {contains: "AI"}},
                                {content: {contains: "AI"}},
                                {authors: {hasSome: ["AI"]}}
                              ]
                            }
                          })
                             â”‚
                             â””â”€ PostgreSQL Query         SELECT * FROM "ResearchPaper"
                                                         WHERE title ILIKE '%AI%'
                                                            OR content ILIKE '%AI%'
                                                            OR 'AI' = ANY(authors)
                                                         LIMIT 10
                                                           â”‚
                                                         Search index checks
                                                         Find matching rows
                                                         Return 10 results
                                                           â”‚
                       Returns array of papers â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â””â”€ count total matches
                       â”‚
                  Returns pagination info
                       â”‚
             HTTP 200 JSON response
                  â”‚
        â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
    Axios.interceptor
        â”‚
    Updates state
        â”‚
    React re-renders
        â”‚
    Display results [Paper 1] [Paper 2] ...
        â”‚
    User clicks bookmark on Paper 1
        â”‚
        â””â”€ POST /bookmarks/paper-1-id
             â”‚
             â”œâ”€ Verify user
             â”‚
             â”œâ”€ bookmarkService.addBookmark()
             â”‚
             â””â”€ prisma.bookmark.upsert            INSERT INTO "Bookmark"
                  â”‚                                VALUES (...)
                  â””â”€ Success              â—„â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
             HTTP 201 response
                  â”‚
        â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
    Update button to "â˜…"
        â”‚
    Add to bookmarks list
        â”‚
    Show "Added to bookmarks" toast


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ¯ KEY TAKEAWAYS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Every Frontend request includes token in Authorization header
2. Backend middleware verifies token on protected routes
3. Controllers coordinate between routes and services
4. Services contain business logic (UserService, ResearchService, etc)
5. Prisma ORM translates code to SQL safely
6. Database enforces relationships and constraints
7. All responses go through error handler for consistency
8. Frontend uses axios interceptors for automatic token inclusion
9. Errors flow back through the same path
10. Database ensures data integrity (foreign keys, cascades, indexes)

This architecture ensures:
âœ… Security (JWT tokens, password hashing)
âœ… Consistency (error handling, validation)
âœ… Performance (indexes, pagination)
âœ… Maintainability (separation of concerns)
âœ… Type safety (TypeScript, Prisma)
âœ… Scalability (stateless, horizontal scaling ready)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
